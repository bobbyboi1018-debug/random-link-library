<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Link Picker with Collections</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
    header { background: #333; color: #fff; padding: 1em; text-align: center; }
    nav { display: flex; justify-content: center; gap: 1em; background: #444; padding: 0.5em; }
    nav button { background: #666; color: #fff; border: none; padding: 0.5em 1em; cursor: pointer; border-radius: 4px; }
    nav button.active { background: #007BFF; }
    .tab { display: none; padding: 1em; }
    .active-tab { display: block; }
    .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1em; }
    .card { background: #fff; border-radius: 6px; padding: 0.5em; box-shadow: 0 2px 5px rgba(0,0,0,0.2); text-align: center; }
    .card img { width: 100%; height: 120px; object-fit: cover; border-radius: 4px; }
    .card button, .card a button { margin-top: 0.3em; display: block; width: 100%; }
    #player { margin-top: 1em; text-align: center; }
    iframe, video { width: 80%; height: 400px; border: none; border-radius: 6px; }
  </style>
</head>
<body>
  <header>
    <h1>ðŸŽ² Link Picker with Collections</h1>
  </header>

  <nav>
    <button onclick="switchTab('add')" class="active">Add & Pick</button>
    <button onclick="switchTab('library')">Library</button>
    <button onclick="switchTab('collections')">Collections</button>
  </nav>

  <!-- Add & Pick Tab -->
  <div id="add" class="tab active-tab">
    <h2>Add a Link</h2>
    <input type="text" id="linkInput" placeholder="Enter link URL" style="width:60%;">
    <button onclick="addLink()">Add</button>
    <button onclick="pickRandom()">ðŸŽ² Pick Random (All)</button>
    <div id="player"></div>
  </div>

  <!-- Library Tab -->
  <div id="library" class="tab">
    <h2>Library</h2>
    <div id="library-cards" class="card-grid"></div>
  </div>

  <!-- Collections Tab -->
  <div id="collections" class="tab">
    <h2>Collections</h2>
    <input type="text" id="collectionName" placeholder="New collection name">
    <button onclick="createCollection()">Create Collection</button>
    <div id="collection-list"></div>
    <div id="collection-view"></div>
  </div>

  <script>
    let savedLinks = JSON.parse(localStorage.getItem("savedLinks")) || [];
    let collections = JSON.parse(localStorage.getItem("collections")) || {};

    // Switch tabs
    function switchTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active-tab'));
      document.getElementById(tabId).classList.add('active-tab');
      document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      if (tabId === "library") renderLibrary();
      if (tabId === "collections") renderCollections();
    }

    // Add link
    function addLink() {
      const url = document.getElementById("linkInput").value.trim();
      if (!url) return alert("Please enter a link");
      savedLinks.push({ url, thumbnail: "", embedCode: url });
      localStorage.setItem("savedLinks", JSON.stringify(savedLinks));
      document.getElementById("linkInput").value = "";
      renderLibrary();
    }

    // Render library
    function renderLibrary() {
      const libraryDiv = document.getElementById("library-cards");
      libraryDiv.innerHTML = "";
      savedLinks.forEach((link, index) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${link.thumbnail || 'https://via.placeholder.com/200x120?text=No+Thumbnail'}">
          <button onclick="playLink('${link.embedCode}')">â–¶ Play</button>
          <button onclick="deleteLink(${index})">ðŸ—‘ Delete</button>
          <a href="${link.url}" target="_blank"><button>ðŸ”— Link</button></a>
          <select onchange="addToCollection('${link.url}', this.value)">
            <option value="">âž• Add to Collection</option>
            ${Object.keys(collections).map(c => `<option value="${c}">${c}</option>`).join("")}
          </select>
        `;
        libraryDiv.appendChild(card);
      });
    }

    // Delete link from library
    function deleteLink(index) {
      savedLinks.splice(index, 1);
      localStorage.setItem("savedLinks", JSON.stringify(savedLinks));
      renderLibrary();
    }

    // Play link
    function playLink(url) {
      const player = document.getElementById("player");
      if (url.endsWith(".mp4")) {
        player.innerHTML = `<video controls autoplay><source src="${url}" type="video/mp4"></video>`;
      } else {
        player.innerHTML = `<iframe src="${url}" allowfullscreen></iframe>`;
      }
    }

    // Pick random from all
    function pickRandom() {
      if (savedLinks.length === 0) return alert("No links saved!");
      const random = savedLinks[Math.floor(Math.random() * savedLinks.length)];
      playLink(random.embedCode || random.url);
    }

    // Collections
    function createCollection() {
      const name = document.getElementById("collectionName").value.trim();
      if (!name) return alert("Enter a collection name");
      if (collections[name]) return alert("Collection already exists!");
      collections[name] = [];
      localStorage.setItem("collections", JSON.stringify(collections));
      document.getElementById("collectionName").value = "";
      renderCollections();
    }

    function renderCollections() {
      const listDiv = document.getElementById("collection-list");
      listDiv.innerHTML = "<h3>Your Collections:</h3>";
      Object.keys(collections).forEach(name => {
        const btn = document.createElement("button");
        btn.textContent = name;
        btn.onclick = () => showCollection(name);
        listDiv.appendChild(btn);
      });
    }

    function showCollection(name) {
      const collectionLinks = collections[name] || [];
      const collectionDiv = document.getElementById("collection-view");
      collectionDiv.innerHTML = `
        <h3>${name}</h3>
        <button onclick="pickRandomFromCollection('${name}')">ðŸŽ² Pick Random</button>
        <div id="collection-cards" class="card-grid"></div>
      `;
      const cardsDiv = document.getElementById("collection-cards");
      collectionLinks.forEach((link, index) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${link.thumbnail || 'https://via.placeholder.com/200x120?text=No+Thumbnail'}">
          <button onclick="playLink('${link.embedCode}')">â–¶ Play</button>
          <button onclick="deleteFromCollection('${name}', ${index})">ðŸ—‘ Delete</button>
          <a href="${link.url}" target="_blank"><button>ðŸ”— Link</button></a>
        `;
        cardsDiv.appendChild(card);
      });
    }

    function addToCollection(url, collectionName) {
      if (!collectionName) return;
      const link = savedLinks.find(l => l.url === url);
      if (!link) return;
      collections[collectionName].push(link);
      localStorage.setItem("collections", JSON.stringify(collections));
    }

    function deleteFromCollection(name, index) {
      collections[name].splice(index, 1);
      localStorage.setItem("collections", JSON.stringify(collections));
      showCollection(name);
    }

    function pickRandomFromCollection(name) {
      const collectionLinks = collections[name] || [];
      if (collectionLinks.length === 0) return alert("This collection is empty!");
      const random = collectionLinks[Math.floor(Math.random() * collectionLinks.length)];
      playLink(random.embedCode || random.url);
    }

    // Initial render
    renderLibrary();
    renderCollections();
  </script>
</body>
</html>
